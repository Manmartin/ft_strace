#include <bits/types/struct_iovec.h>
#include <stdint.h>
#include <stdio.h>

#include "ft_strace.h"

syscall_t syscall_table64[] = {
    [0]   = {"read", 3},
    [1]   = {"write", 3},
    [2]   = {"open", 3},
    [3]   = {"close", 1},
    [4]   = {"newstat", 2},
    [5]   = {"newfstat", 2},
    [6]   = {"newlstat", 2},
    [7]   = {"poll", 3},
    [8]   = {"lseek", 3},
    [9]   = {"mmap", 6},
    [10]  = {"mprotect", 3},
    [11]  = {"munmap", 2},
    [12]  = {"brk", 1},
    [13]  = {"rt_sigaction", 4},
    [14]  = {"rt_sigprocmask", 4},
    [15]  = {"rt_sigreturn", 0},
    [16]  = {"ioctl", 3},
    [17]  = {"pread64", 4},
    [18]  = {"pwrite64", 4},
    [19]  = {"readv", 3},
    [20]  = {"writev", 3},
    [21]  = {"access", 2},
    [22]  = {"pipe", 1},
    [23]  = {"select", 5},
    [24]  = {"sched_yield", 0},
    [25]  = {"mremap", 5},
    [26]  = {"msync", 3},
    [27]  = {"mincore", 3},
    [28]  = {"madvise", 3},
    [29]  = {"shmget", 3},
    [30]  = {"shmat", 3},
    [31]  = {"shmctl", 3},
    [32]  = {"dup", 1},
    [33]  = {"dup2", 2},
    [34]  = {"pause", 0},
    [35]  = {"nanosleep", 2},
    [36]  = {"getitimer", 2},
    [37]  = {"alarm", 1},
    [38]  = {"setitimer", 3},
    [39]  = {"getpid", 0},
    [40]  = {"sendfile64", 4},
    [41]  = {"socket", 3},
    [42]  = {"connect", 3},
    [43]  = {"accept", 3},
    [44]  = {"sendto", 6},
    [45]  = {"recvfrom", 6},
    [46]  = {"sendmsg", 3},
    [47]  = {"recvmsg", 3},
    [48]  = {"shutdown", 2},
    [49]  = {"bind", 3},
    [50]  = {"listen", 2},
    [51]  = {"getsockname", 3},
    [52]  = {"getpeername", 3},
    [53]  = {"socketpair", 4},
    [54]  = {"setsockopt", 5},
    [55]  = {"getsockopt", 5},
    [56]  = {"clone", 5},
    [57]  = {"fork", 0},
    [58]  = {"vfork", 0},
    [59]  = {"execve", 3},
    [60]  = {"exit", 1},
    [61]  = {"wait4", 4},
    [62]  = {"kill", 2},
    [63]  = {"newuname", 1},
    [64]  = {"semget", 3},
    [65]  = {"semop", 3},
    [66]  = {"semctl", 4},
    [67]  = {"shmdt", 1},
    [68]  = {"msgget", 2},
    [69]  = {"msgsnd", 4},
    [70]  = {"msgrcv", 5},
    [71]  = {"msgctl", 3},
    [72]  = {"fcntl", 3},
    [73]  = {"flock", 2},
    [74]  = {"fsync", 1},
    [75]  = {"fdatasync", 1},
    [76]  = {"truncate", 2},
    [77]  = {"ftruncate", 2},
    [78]  = {"getdents", 3},
    [79]  = {"getcwd", 2},
    [80]  = {"chdir", 1},
    [81]  = {"fchdir", 1},
    [82]  = {"rename", 2},
    [83]  = {"mkdir", 2},
    [84]  = {"rmdir", 1},
    [85]  = {"creat", 2},
    [86]  = {"link", 2},
    [87]  = {"unlink", 1},
    [88]  = {"symlink", 2},
    [89]  = {"readlink", 3},
    [90]  = {"chmod", 2},
    [91]  = {"fchmod", 2},
    [92]  = {"chown", 3},
    [93]  = {"fchown", 3},
    [94]  = {"lchown", 3},
    [95]  = {"umask", 1},
    [96]  = {"gettimeofday", 2},
    [97]  = {"getrlimit", 2},
    [98]  = {"getrusage", 2},
    [99]  = {"sysinfo", 1},
    [100] = {"times", 1},
    [101] = {"ptrace", 4},
    [102] = {"getuid", 0},
    [103] = {"syslog", 3},
    [104] = {"getgid", 0},
    [105] = {"setuid", 1},
    [106] = {"setgid", 1},
    [107] = {"geteuid", 0},
    [108] = {"getegid", 0},
    [109] = {"setpgid", 2},
    [110] = {"getppid", 0},
    [111] = {"getpgrp", 0},
    [112] = {"setsid", 0},
    [113] = {"setreuid", 2},
    [114] = {"setregid", 2},
    [115] = {"getgroups", 2},
    [116] = {"setgroups", 2},
    [117] = {"setresuid", 3},
    [118] = {"getresuid", 3},
    [119] = {"setresgid", 3},
    [120] = {"getresgid", 3},
    [121] = {"getpgid", 1},
    [122] = {"setfsuid", 1},
    [123] = {"setfsgid", 1},
    [124] = {"getsid", 1},
    [125] = {"capget", 2},
    [126] = {"capset", 2},
    [127] = {"rt_sigpending", 2},
    [128] = {"rt_sigtimedwait", 4},
    [129] = {"rt_sigqueueinfo", 3},
    [130] = {"rt_sigsuspend", 2},
    [131] = {"sigaltstack", 2},
    [132] = {"utime", 2},
    [133] = {"mknod", 3},
    [135] = {"personality", 1},
    [136] = {"ustat", 2},
    [137] = {"statfs", 2},
    [138] = {"fstatfs", 2},
    [139] = {"sysfs", 3},
    [140] = {"getpriority", 2},
    [141] = {"setpriority", 3},
    [142] = {"sched_setparam", 2},
    [143] = {"sched_getparam", 2},
    [144] = {"sched_setscheduler", 3},
    [145] = {"sched_getscheduler", 1},
    [146] = {"sched_get_priority_max", 1},
    [147] = {"sched_get_priority_min", 1},
    [148] = {"sched_rr_get_interval", 2},
    [149] = {"mlock", 2},
    [150] = {"munlock", 2},
    [151] = {"mlockall", 1},
    [152] = {"munlockall", 0},
    [153] = {"vhangup", 0},
    [154] = {"modify_ldt", 3},
    [155] = {"pivot_root", 2},
    [157] = {"prctl", 5},
    [158] = {"arch_prctl", 2},
    [159] = {"adjtimex", 1},
    [160] = {"setrlimit", 2},
    [161] = {"chroot", 1},
    [162] = {"sync", 0},
    [163] = {"acct", 1},
    [164] = {"settimeofday", 2},
    [165] = {"mount", 5},
    [166] = {"umount", 2},
    [167] = {"swapon", 2},
    [168] = {"swapoff", 1},
    [169] = {"reboot", 4},
    [170] = {"sethostname", 2},
    [171] = {"setdomainname", 2},
    [172] = {"iopl", 1},
    [173] = {"ioperm", 3},
    [175] = {"init_module", 3},
    [176] = {"delete_module", 2},
    [179] = {"quotactl", 4},
    [186] = {"gettid", 0},
    [187] = {"readahead", 3},
    [188] = {"setxattr", 5},
    [189] = {"lsetxattr", 5},
    [190] = {"fsetxattr", 5},
    [191] = {"getxattr", 4},
    [192] = {"lgetxattr", 4},
    [193] = {"fgetxattr", 4},
    [194] = {"listxattr", 3},
    [195] = {"llistxattr", 3},
    [196] = {"flistxattr", 3},
    [197] = {"removexattr", 2},
    [198] = {"lremovexattr", 2},
    [199] = {"fremovexattr", 2},
    [200] = {"tkill", 2},
    [201] = {"time", 1},
    [202] = {"futex", 6},
    [203] = {"sched_setaffinity", 3},
    [204] = {"sched_getaffinity", 3},
    [206] = {"io_setup", 2},
    [207] = {"io_destroy", 1},
    [208] = {"io_getevents", 5},
    [209] = {"io_submit", 3},
    [210] = {"io_cancel", 3},
    [213] = {"epoll_create", 1},
    [216] = {"remap_file_pages", 5},
    [217] = {"getdents64", 3},
    [218] = {"set_tid_address", 1},
    [219] = {"restart_syscall", 0},
    [220] = {"semtimedop", 4},
    [221] = {"fadvise64", 4},
    [222] = {"timer_create", 3},
    [223] = {"timer_settime", 4},
    [224] = {"timer_gettime", 2},
    [225] = {"timer_getoverrun", 1},
    [226] = {"timer_delete", 1},
    [227] = {"clock_settime", 2},
    [228] = {"clock_gettime", 2},
    [229] = {"clock_getres", 2},
    [230] = {"clock_nanosleep", 4},
    [231] = {"exit_group", 1},
    [232] = {"epoll_wait", 4},
    [233] = {"epoll_ctl", 4},
    [234] = {"tgkill", 3},
    [235] = {"utimes", 2},
    [237] = {"mbind", 6},
    [238] = {"set_mempolicy", 3},
    [239] = {"get_mempolicy", 5},
    [240] = {"mq_open", 4},
    [241] = {"mq_unlink", 1},
    [242] = {"mq_timedsend", 5},
    [243] = {"mq_timedreceive", 5},
    [244] = {"mq_notify", 2},
    [245] = {"mq_getsetattr", 3},
    [246] = {"kexec_load", 4},
    [247] = {"waitid", 5},
    [248] = {"add_key", 5},
    [249] = {"request_key", 4},
    [250] = {"keyctl", 5},
    [251] = {"ioprio_set", 3},
    [252] = {"ioprio_get", 2},
    [253] = {"inotify_init", 0},
    [254] = {"inotify_add_watch", 3},
    [255] = {"inotify_rm_watch", 2},
    [256] = {"migrate_pages", 4},
    [257] = {"openat", 4},
    [258] = {"mkdirat", 3},
    [259] = {"mknodat", 4},
    [260] = {"fchownat", 5},
    [261] = {"futimesat", 3},
    [262] = {"newfstatat", 4},
    [263] = {"unlinkat", 3},
    [264] = {"renameat", 4},
    [265] = {"linkat", 5},
    [266] = {"symlinkat", 3},
    [267] = {"readlinkat", 4},
    [268] = {"fchmodat", 3},
    [269] = {"faccessat", 3},
    [270] = {"pselect6", 6},
    [271] = {"ppoll", 5},
    [272] = {"unshare", 1},
    [273] = {"set_robust_list", 2},
    [274] = {"get_robust_list", 3},
    [275] = {"splice", 6},
    [276] = {"tee", 4},
    [277] = {"sync_file_range", 4},
    [278] = {"vmsplice", 4},
    [279] = {"move_pages", 6},
    [280] = {"utimensat", 4},
    [281] = {"epoll_pwait", 6},
    [282] = {"signalfd", 3},
    [283] = {"timerfd_create", 2},
    [284] = {"eventfd", 1},
    [285] = {"fallocate", 4},
    [286] = {"timerfd_settime", 4},
    [287] = {"timerfd_gettime", 2},
    [288] = {"accept4", 4},
    [289] = {"signalfd4", 4},
    [290] = {"eventfd2", 2},
    [291] = {"epoll_create1", 1},
    [292] = {"dup3", 3},
    [293] = {"pipe2", 2},
    [294] = {"inotify_init1", 1},
    [295] = {"preadv", 5},
    [296] = {"pwritev", 5},
    [297] = {"rt_tgsigqueueinfo", 4},
    [298] = {"perf_event_open", 5},
    [299] = {"recvmmsg", 5},
    [300] = {"fanotify_init", 2},
    [301] = {"fanotify_mark", 5},
    [302] = {"prlimit64", 4},
    [303] = {"name_to_handle_at", 5},
    [304] = {"open_by_handle_at", 3},
    [305] = {"clock_adjtime", 2},
    [306] = {"syncfs", 1},
    [307] = {"sendmmsg", 4},
    [308] = {"setns", 2},
    [309] = {"getcpu", 3},
    [310] = {"process_vm_readv", 6},
    [311] = {"process_vm_writev", 6},
    [312] = {"kcmp", 5},
    [313] = {"finit_module", 3},
    [314] = {"sched_setattr", 3},
    [315] = {"sched_getattr", 4},
    [316] = {"renameat2", 5},
    [317] = {"seccomp", 3},
    [318] = {"getrandom", 3},
    [319] = {"memfd_create", 2},
    [320] = {"kexec_file_load", 5},
    [321] = {"bpf", 3},
    [322] = {"execveat", 5},
    [323] = {"userfaultfd", 1},
    [324] = {"membarrier", 3},
    [325] = {"mlock2", 3},
    [326] = {"copy_file_range", 6},
    [327] = {"preadv2", 6},
    [328] = {"pwritev2", 6},
    [329] = {"pkey_mprotect", 4},
    [330] = {"pkey_alloc", 2},
    [331] = {"pkey_free", 1},
    [332] = {"statx", 5},
    [333] = {"io_pgetevents", 6},
    [334] = {"rseq", 4},
    [335] = {"uretprobe", 0},
    [424] = {"pidfd_send_signal", 4},
    [425] = {"io_uring_setup", 2},
    [426] = {"io_uring_enter", 6},
    [427] = {"io_uring_register", 4},
    [428] = {"open_tree", 3},
    [429] = {"move_mount", 5},
    [430] = {"fsopen", 2},
    [431] = {"fsconfig", 5},
    [432] = {"fsmount", 3},
    [433] = {"fspick", 3},
    [434] = {"pidfd_open", 2},
    [435] = {"clone3", 2},
    [436] = {"close_range", 3},
    [437] = {"openat2", 4},
    [438] = {"pidfd_getfd", 3},
    [439] = {"faccessat2", 4},
    [440] = {"process_madvise", 5},
    [441] = {"epoll_pwait2", 6},
    [442] = {"mount_setattr", 5},
    [443] = {"quotactl_fd", 4},
    [444] = {"landlock_create_ruleset", 3},
    [445] = {"landlock_add_rule", 4},
    [446] = {"landlock_restrict_self", 2},
    [447] = {"memfd_secret", 1},
    [448] = {"process_mrelease", 2},
    [449] = {"futex_waitv", 5},
    [450] = {"set_mempolicy_home_node", 4},
    [451] = {"cachestat", 4},
    [452] = {"fchmodat2", 4},
    [453] = {"map_shadow_stack", 3},
    [454] = {"futex_wake", 4},
    [455] = {"futex_wait", 6},
    [456] = {"futex_requeue", 4},
    [457] = {"statmount", 4},
    [458] = {"listmount", 4},
    [459] = {"lsm_get_self_attr", 4},
    [460] = {"lsm_set_self_attr", 4},
    [461] = {"lsm_list_modules", 3},
    [462] = {"mseal", 3},
    [463] = {"setxattrat", 6},
    [464] = {"getxattrat", 6},
    [465] = {"listxattrat", 5},
    [466] = {"removexattrat", 4},
    [467] = {"open_tree_attr", 5},
    [468] = {"file_getattr", 5},
    [469] = {"file_setattr", 5},
};

syscall_t syscall_table32[] = {
    [0]   = {"restart_syscall", 0},
    [1]   = {"exit", 1},
    [2]   = {"fork", 0},
    [3]   = {"read", 3},
    [4]   = {"write", 3},
    [5]   = {"open", 3},
    [6]   = {"close", 1},
    [7]   = {"waitpid", 3},
    [8]   = {"creat", 2},
    [9]   = {"link", 2},
    [10]  = {"unlink", 1},
    [11]  = {"execve", 3},
    [12]  = {"chdir", 1},
    [13]  = {"time", 1},
    [14]  = {"mknod", 3},
    [15]  = {"chmod", 2},
    [16]  = {"lchown16", 3},
    [18]  = {"stat", 2},
    [19]  = {"lseek", 3},
    [20]  = {"getpid", 0},
    [21]  = {"mount", 5},
    [22]  = {"oldumount", 1},
    [23]  = {"setuid16", 1},
    [24]  = {"getuid16", 0},
    [25]  = {"stime", 1},
    [26]  = {"ptrace", 4},
    [27]  = {"alarm", 1},
    [28]  = {"fstat", 2},
    [29]  = {"pause", 0},
    [30]  = {"utime", 2},
    [33]  = {"access", 2},
    [34]  = {"nice", 1},
    [36]  = {"sync", 0},
    [37]  = {"kill", 2},
    [38]  = {"rename", 2},
    [39]  = {"mkdir", 2},
    [40]  = {"rmdir", 1},
    [41]  = {"dup", 1},
    [42]  = {"pipe", 1},
    [43]  = {"times", 1},
    [45]  = {"brk", 1},
    [46]  = {"setgid16", 1},
    [47]  = {"getgid16", 0},
    [48]  = {"signal", 2},
    [49]  = {"geteuid16", 0},
    [50]  = {"getegid16", 0},
    [51]  = {"acct", 1},
    [52]  = {"umount", 2},
    [54]  = {"ioctl", 3},
    [55]  = {"fcntl64", 3},
    [57]  = {"setpgid", 2},
    [59]  = {"olduname", 1},
    [60]  = {"umask", 1},
    [61]  = {"chroot", 1},
    [62]  = {"ustat", 2},
    [63]  = {"dup2", 2},
    [64]  = {"getppid", 0},
    [65]  = {"getpgrp", 0},
    [66]  = {"setsid", 0},
    [67]  = {"sigaction", 3},
    [68]  = {"sgetmask", 0},
    [69]  = {"ssetmask", 1},
    [70]  = {"setreuid16", 2},
    [71]  = {"setregid16", 2},
    [72]  = {"sigsuspend", 3},
    [73]  = {"sigpending", 1},
    [74]  = {"sethostname", 2},
    [75]  = {"setrlimit", 2},
    [76]  = {"getrlimit", 2},
    [77]  = {"getrusage", 2},
    [78]  = {"gettimeofday", 2},
    [79]  = {"settimeofday", 2},
    [80]  = {"getgroups16", 2},
    [81]  = {"setgroups16", 2},
    [82]  = {"select", 1},
    [83]  = {"symlink", 2},
    [84]  = {"lstat", 2},
    [85]  = {"readlink", 3},
    [87]  = {"swapon", 2},
    [88]  = {"reboot", 4},
    [89]  = {"readdir", 3},
    [90]  = {"mmap", 1},
    [91]  = {"munmap", 2},
    [92]  = {"truncate", 2},
    [93]  = {"ftruncate", 2},
    [94]  = {"fchmod", 2},
    [95]  = {"fchown16", 3},
    [96]  = {"getpriority", 2},
    [97]  = {"setpriority", 3},
    [99]  = {"statfs", 2},
    [100] = {"fstatfs", 2},
    [101] = {"ioperm", 3},
    [102] = {"socketcall", 2},
    [103] = {"syslog", 3},
    [104] = {"setitimer", 3},
    [105] = {"getitimer", 2},
    [106] = {"newstat", 2},
    [107] = {"newlstat", 2},
    [108] = {"newfstat", 2},
    [109] = {"uname", 1},
    [110] = {"iopl", 1},
    [111] = {"vhangup", 0},
    [114] = {"wait4", 4},
    [115] = {"swapoff", 1},
    [116] = {"sysinfo", 1},
    [117] = {"ipc", 6},
    [118] = {"fsync", 1},
    [119] = {"sigreturn", 0},
    [120] = {"clone", 5},
    [121] = {"setdomainname", 2},
    [122] = {"newuname", 1},
    [123] = {"modify_ldt", 3},
    [124] = {"adjtimex", 1},
    [125] = {"mprotect", 3},
    [126] = {"sigprocmask", 3},
    [128] = {"init_module", 3},
    [129] = {"delete_module", 2},
    [131] = {"quotactl", 4},
    [132] = {"getpgid", 1},
    [133] = {"fchdir", 1},
    [135] = {"sysfs", 3},
    [136] = {"personality", 1},
    [138] = {"setfsuid16", 1},
    [139] = {"setfsgid16", 1},
    [140] = {"llseek", 5},
    [141] = {"getdents", 3},
    [142] = {"select", 5},
    [143] = {"flock", 2},
    [144] = {"msync", 3},
    [145] = {"readv", 3},
    [146] = {"writev", 3},
    [147] = {"getsid", 1},
    [148] = {"fdatasync", 1},
    [150] = {"mlock", 2},
    [151] = {"munlock", 2},
    [152] = {"mlockall", 1},
    [153] = {"munlockall", 0},
    [154] = {"sched_setparam", 2},
    [155] = {"sched_getparam", 2},
    [156] = {"sched_setscheduler", 3},
    [157] = {"sched_getscheduler", 1},
    [158] = {"sched_yield", 0},
    [159] = {"sched_get_priority_max", 1},
    [160] = {"sched_get_priority_min", 1},
    [161] = {"sched_rr_get_interval", 2},
    [162] = {"nanosleep", 2},
    [163] = {"mremap", 5},
    [164] = {"setresuid16", 3},
    [165] = {"getresuid16", 3},
    [168] = {"poll", 3},
    [170] = {"setresgid16", 3},
    [171] = {"getresgid16", 3},
    [172] = {"prctl", 5},
    [173] = {"rt_sigreturn", 0},
    [174] = {"rt_sigaction", 4},
    [175] = {"rt_sigprocmask", 4},
    [176] = {"rt_sigpending", 2},
    [177] = {"rt_sigtimedwait", 4},
    [178] = {"rt_sigqueueinfo", 3},
    [179] = {"rt_sigsuspend", 2},
    [180] = {"pread64", 5},
    [181] = {"pwrite64", 5},
    [182] = {"chown16", 3},
    [183] = {"getcwd", 2},
    [184] = {"capget", 2},
    [185] = {"capset", 2},
    [186] = {"sigaltstack", 2},
    [187] = {"sendfile", 4},
    [190] = {"vfork", 0},
    [191] = {"getrlimit", 2},
    [192] = {"mmap_pgoff", 6},
    [193] = {"truncate64", 3},
    [194] = {"ftruncate64", 3},
    [195] = {"stat64", 2},
    [196] = {"lstat64", 2},
    [197] = {"fstat64", 2},
    [198] = {"lchown", 3},
    [199] = {"getuid", 0},
    [200] = {"getgid", 0},
    [201] = {"geteuid", 0},
    [202] = {"getegid", 0},
    [203] = {"setreuid", 2},
    [204] = {"setregid", 2},
    [205] = {"getgroups", 2},
    [206] = {"setgroups", 2},
    [207] = {"fchown", 3},
    [208] = {"setresuid", 3},
    [209] = {"getresuid", 3},
    [210] = {"setresgid", 3},
    [211] = {"getresgid", 3},
    [212] = {"chown", 3},
    [213] = {"setuid", 1},
    [214] = {"setgid", 1},
    [215] = {"setfsuid", 1},
    [216] = {"setfsgid", 1},
    [217] = {"pivot_root", 2},
    [218] = {"mincore", 3},
    [219] = {"madvise", 3},
    [220] = {"getdents64", 3},
    [221] = {"fcntl64", 3},
    [224] = {"gettid", 0},
    [225] = {"readahead", 4},
    [226] = {"setxattr", 5},
    [227] = {"lsetxattr", 5},
    [228] = {"fsetxattr", 5},
    [229] = {"getxattr", 4},
    [230] = {"lgetxattr", 4},
    [231] = {"fgetxattr", 4},
    [232] = {"listxattr", 3},
    [233] = {"llistxattr", 3},
    [234] = {"flistxattr", 3},
    [235] = {"removexattr", 2},
    [236] = {"lremovexattr", 2},
    [237] = {"fremovexattr", 2},
    [238] = {"tkill", 2},
    [239] = {"sendfile64", 4},
    [240] = {"futex", 6},
    [241] = {"sched_setaffinity", 3},
    [242] = {"sched_getaffinity", 3},
    [243] = {"set_thread_area", 1},
    [244] = {"get_thread_area", 1},
    [245] = {"io_setup", 2},
    [246] = {"io_destroy", 1},
    [247] = {"io_getevents", 5},
    [248] = {"io_submit", 3},
    [249] = {"io_cancel", 3},
    [250] = {"fadvise64", 5},
    [252] = {"exit_group", 1},
    [254] = {"epoll_create", 1},
    [255] = {"epoll_ctl", 4},
    [256] = {"epoll_wait", 4},
    [257] = {"remap_file_pages", 5},
    [258] = {"set_tid_address", 1},
    [259] = {"timer_create", 3},
    [260] = {"timer_settime", 4},
    [261] = {"timer_gettime", 2},
    [262] = {"timer_getoverrun", 1},
    [263] = {"timer_delete", 1},
    [264] = {"clock_settime", 2},
    [265] = {"clock_gettime", 2},
    [266] = {"clock_getres", 2},
    [267] = {"clock_nanosleep", 4},
    [268] = {"statfs64", 3},
    [269] = {"fstatfs64", 3},
    [270] = {"tgkill", 3},
    [271] = {"utimes", 2},
    [272] = {"fadvise64_64", 6},
    [274] = {"mbind", 6},
    [275] = {"get_mempolicy", 5},
    [276] = {"set_mempolicy", 3},
    [277] = {"mq_open", 4},
    [278] = {"mq_unlink", 1},
    [279] = {"mq_timedsend", 5},
    [280] = {"mq_timedreceive", 5},
    [281] = {"mq_notify", 2},
    [282] = {"mq_getsetattr", 3},
    [283] = {"kexec_load", 4},
    [284] = {"waitid", 5},
    [286] = {"add_key", 5},
    [287] = {"request_key", 4},
    [288] = {"keyctl", 5},
    [289] = {"ioprio_set", 3},
    [290] = {"ioprio_get", 2},
    [291] = {"inotify_init", 0},
    [292] = {"inotify_add_watch", 3},
    [293] = {"inotify_rm_watch", 2},
    [294] = {"migrate_pages", 4},
    [295] = {"openat", 4},
    [296] = {"mkdirat", 3},
    [297] = {"mknodat", 4},
    [298] = {"fchownat", 5},
    [299] = {"futimesat", 3},
    [300] = {"fstatat64", 4},
    [301] = {"unlinkat", 3},
    [302] = {"renameat", 4},
    [303] = {"linkat", 5},
    [304] = {"symlinkat", 3},
    [305] = {"readlinkat", 4},
    [306] = {"fchmodat", 3},
    [307] = {"faccessat", 3},
    [308] = {"pselect6", 6},
    [309] = {"ppoll", 5},
    [310] = {"unshare", 1},
    [311] = {"set_robust_list", 2},
    [312] = {"get_robust_list", 3},
    [313] = {"splice", 6},
    [314] = {"sync_file_range", 6},
    [315] = {"tee", 4},
    [316] = {"vmsplice", 4},
    [317] = {"move_pages", 6},
    [318] = {"getcpu", 3},
    [319] = {"epoll_pwait", 6},
    [320] = {"utimensat", 4},
    [321] = {"signalfd", 3},
    [322] = {"timerfd_create", 2},
    [323] = {"eventfd", 1},
    [324] = {"fallocate", 6},
    [325] = {"timerfd_settime", 4},
    [326] = {"timerfd_gettime", 2},
    [327] = {"signalfd4", 4},
    [328] = {"eventfd2", 2},
    [329] = {"epoll_create1", 1},
    [330] = {"dup3", 3},
    [331] = {"pipe2", 2},
    [332] = {"inotify_init1", 1},
    [333] = {"preadv", 5},
    [334] = {"pwritev", 5},
    [335] = {"rt_tgsigqueueinfo", 4},
    [336] = {"perf_event_open", 5},
    [337] = {"recvmmsg", 5},
    [338] = {"fanotify_init", 2},
    [339] = {"fanotify_mark", 6},
    [340] = {"prlimit64", 4},
    [341] = {"name_to_handle_at", 5},
    [342] = {"open_by_handle_at", 3},
    [343] = {"clock_adjtime", 2},
    [344] = {"syncfs", 1},
    [345] = {"sendmmsg", 4},
    [346] = {"setns", 2},
    [347] = {"process_vm_readv", 6},
    [348] = {"process_vm_writev", 6},
    [349] = {"kcmp", 5},
    [350] = {"finit_module", 3},
    [351] = {"sched_setattr", 3},
    [352] = {"sched_getattr", 4},
    [353] = {"renameat2", 5},
    [354] = {"seccomp", 3},
    [355] = {"getrandom", 3},
    [356] = {"memfd_create", 2},
    [357] = {"bpf", 3},
    [358] = {"execveat", 5},
    [359] = {"socket", 3},
    [360] = {"socketpair", 4},
    [361] = {"bind", 3},
    [362] = {"connect", 3},
    [363] = {"listen", 2},
    [364] = {"accept4", 4},
    [365] = {"getsockopt", 5},
    [366] = {"setsockopt", 5},
    [367] = {"getsockname", 3},
    [368] = {"getpeername", 3},
    [369] = {"sendto", 6},
    [370] = {"sendmsg", 3},
    [371] = {"recvfrom", 6},
    [372] = {"recvmsg", 3},
    [373] = {"shutdown", 2},
    [374] = {"userfaultfd", 1},
    [375] = {"membarrier", 3},
    [376] = {"mlock2", 3},
    [377] = {"copy_file_range", 6},
    [378] = {"preadv2", 6},
    [379] = {"pwritev2", 6},
    [380] = {"pkey_mprotect", 4},
    [381] = {"pkey_alloc", 2},
    [382] = {"pkey_free", 1},
    [383] = {"statx", 5},
    [384] = {"arch_prctl", 2},
    [385] = {"io_pgetevents", 6},
    [386] = {"rseq", 4},
    [393] = {"semget", 3},
    [394] = {"semctl", 4},
    [395] = {"shmget", 3},
    [396] = {"shmctl", 3},
    [397] = {"shmat", 3},
    [398] = {"shmdt", 1},
    [399] = {"msgget", 2},
    [400] = {"msgsnd", 4},
    [401] = {"msgrcv", 5},
    [402] = {"msgctl", 3},
    [403] = {"clock_gettime", 2},
    [404] = {"clock_settime", 2},
    [405] = {"clock_adjtime", 2},
    [406] = {"clock_getres", 2},
    [407] = {"clock_nanosleep", 4},
    [408] = {"timer_gettime", 2},
    [409] = {"timer_settime", 4},
    [410] = {"timerfd_gettime", 2},
    [411] = {"timerfd_settime", 4},
    [412] = {"utimensat", 4},
    [413] = {"pselect6", 6},
    [414] = {"ppoll", 5},
    [416] = {"io_pgetevents", 6},
    [417] = {"recvmmsg", 5},
    [418] = {"mq_timedsend", 5},
    [419] = {"mq_timedreceive", 5},
    [420] = {"semtimedop", 4},
    [421] = {"rt_sigtimedwait", 4},
    [422] = {"futex", 6},
    [423] = {"sched_rr_get_interval", 2},
    [424] = {"pidfd_send_signal", 4},
    [425] = {"io_uring_setup", 2},
    [426] = {"io_uring_enter", 6},
    [427] = {"io_uring_register", 4},
    [428] = {"open_tree", 3},
    [429] = {"move_mount", 5},
    [430] = {"fsopen", 2},
    [431] = {"fsconfig", 5},
    [432] = {"fsmount", 3},
    [433] = {"fspick", 3},
    [434] = {"pidfd_open", 2},
    [435] = {"clone3", 2},
    [436] = {"close_range", 3},
    [437] = {"openat2", 4},
    [438] = {"pidfd_getfd", 3},
    [439] = {"faccessat2", 4},
    [440] = {"process_madvise", 5},
    [441] = {"epoll_pwait2", 6},
    [442] = {"mount_setattr", 5},
    [443] = {"quotactl_fd", 4},
    [444] = {"landlock_create_ruleset", 3},
    [445] = {"landlock_add_rule", 4},
    [446] = {"landlock_restrict_self", 2},
    [447] = {"memfd_secret", 1},
    [448] = {"process_mrelease", 2},
    [449] = {"futex_waitv", 5},
    [450] = {"set_mempolicy_home_node", 4},
    [451] = {"cachestat", 4},
    [452] = {"fchmodat2", 4},
    [453] = {"map_shadow_stack", 3},
    [454] = {"futex_wake", 4},
    [455] = {"futex_wait", 6},
    [456] = {"futex_requeue", 4},
    [457] = {"statmount", 4},
    [458] = {"listmount", 4},
    [459] = {"lsm_get_self_attr", 4},
    [460] = {"lsm_set_self_attr", 4},
    [461] = {"lsm_list_modules", 3},
    [462] = {"mseal", 3},
    [463] = {"setxattrat", 6},
    [464] = {"getxattrat", 6},
    [465] = {"listxattrat", 5},
    [466] = {"removexattrat", 4},
    [467] = {"open_tree_attr", 5},
    [468] = {"file_getattr", 5},
    [469] = {"file_setattr", 5},
};

void print_syscall64(struct user_regs_struct *regs) {
    uint64_t syscall_number = regs->orig_rax;
    uint32_t argc           = syscall_table64[syscall_number].argc;
    const char *name        = syscall_table64[syscall_number].name;

    switch (argc) {
    case 0:
        fprintf(stderr, "%s()", name);
        break;
    case 1:
        fprintf(stderr, "%s(%lli)", name, regs->rdi);
        break;
    case 2:
        fprintf(stderr, "%s(%lli, %lli)", name, regs->rdi, regs->rsi);
        break;
    case 3:
        fprintf(stderr, "%s(%lli, %lli, %lli)", name, regs->rdi, regs->rsi,
                regs->rdx);
        break;
    case 4:
        fprintf(stderr, "%s(%lli, %lli, %lli, %lli)", name, regs->rdi,
                regs->rsi, regs->rdx, regs->r10);
        break;
    case 5:
        fprintf(stderr, "%s(%lli, %lli, %lli, %lli, %lli)", name, regs->rdi,
                regs->rsi, regs->rdx, regs->r10, regs->r8);
        break;
    case 6:
        fprintf(stderr, "%s(%lli, %lli, %lli, %lli, %lli, %lli)", name,
                regs->rdi, regs->rsi, regs->rdx, regs->r10, regs->r8, regs->r9);
        break;
    default:
        fprintf(stderr, "%s(?)", name);
    }
}

void print_syscall32(struct user_regs_struct32 *regs) {
    uint32_t syscall_number = regs->orig_eax;
    uint32_t argc           = syscall_table32[syscall_number].argc;
    const char *name        = syscall_table32[syscall_number].name;

    switch (argc) {
    case 0:
        fprintf(stderr, "%s()", name);
        break;
    case 1:
        fprintf(stderr, "%s(%i)", name, regs->ebx);
        break;
    case 2:
        fprintf(stderr, "%s(%i, %i)", name, regs->ebx, regs->ecx);
        break;
    case 3:
        fprintf(stderr, "%s(%i, %i, %i)", name, regs->ebx, regs->ecx,
                regs->edx);
        break;
    case 4:
        fprintf(stderr, "%s(%i, %i, %i, %i)", name, regs->ebx, regs->ecx,
                regs->edx, regs->esi);
        break;
    case 5:
        fprintf(stderr, "%s(%i, %i, %i, %i, %i)", name, regs->ebx, regs->ecx,
                regs->edx, regs->esi, regs->edi);
        break;
    case 6:
        fprintf(stderr, "%s(%i, %i, %i, %i, %i, %i)", name, regs->ebx,
                regs->ecx, regs->edx, regs->esi, regs->edi, regs->ebp);
        break;
    default:
        fprintf(stderr, "%s(?)", name);
    }
}
